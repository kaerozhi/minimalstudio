---
import { getCollection } from "astro:content";
import { extractMarkdownImages } from "@/utils/extractImages";
import BaseLayout from "@/layouts/BaseLayout.astro";
import CascadingGallery from "@/components/entries/CascadingGallery.astro";

const posts = await getCollection("gallery");
let allImages: string[] = [];

for (const post of posts) {
  // ✅ post.body 是 Markdown 源码字符串（只在 content collections 中可用）
  const content = post.body;
  if (content) {
    const images = extractMarkdownImages(content);
    allImages = [...allImages, ...images];
  }
}
---
<BaseLayout>
  <section class="px-4 max-w-7xl mx-auto py-12">
    <div class="mt-32"></div>
    <h1 class="text-2xl font-bold mb-6">我的旅行照片</h1>
    <CascadingGallery images={allImages} />
  </section>
</BaseLayout>